Version 4
SHEET 1 1628 1124
WIRE -1440 -432 -1600 -432
WIRE -1376 -432 -1440 -432
WIRE -1296 -432 -1376 -432
WIRE -1072 -432 -1296 -432
WIRE -896 -432 -976 -432
WIRE -752 -432 -896 -432
WIRE -544 -432 -752 -432
WIRE -368 -432 -544 -432
WIRE -256 -432 -368 -432
WIRE -112 -432 -256 -432
WIRE 128 -432 128 -496
WIRE 128 -432 -112 -432
WIRE 224 -432 128 -432
WIRE 320 -432 224 -432
WIRE 352 -432 320 -432
WIRE 464 -432 432 -432
WIRE 512 -432 464 -432
WIRE 688 -432 592 -432
WIRE -1296 -400 -1296 -432
WIRE -368 -384 -368 -432
WIRE -256 -384 -256 -432
WIRE -112 -384 -112 -432
WIRE 320 -368 320 -432
WIRE -1168 -336 -1200 -336
WIRE -1056 -336 -1056 -384
WIRE -1056 -336 -1104 -336
WIRE -752 -336 -752 -432
WIRE 688 -336 688 -432
WIRE 736 -336 688 -336
WIRE 832 -336 800 -336
WIRE 944 -336 832 -336
WIRE 1008 -336 944 -336
WIRE 1152 -336 1088 -336
WIRE 1392 -336 1152 -336
WIRE 464 -320 464 -432
WIRE 464 -320 416 -320
WIRE -1296 -256 -1296 -336
WIRE -1200 -256 -1200 -336
WIRE -1200 -256 -1296 -256
WIRE -1168 -256 -1200 -256
WIRE -1056 -256 -1056 -336
WIRE -1056 -256 -1088 -256
WIRE -1008 -256 -1056 -256
WIRE -896 -256 -896 -432
WIRE -896 -256 -944 -256
WIRE -368 -256 -368 -320
WIRE -256 -256 -256 -320
WIRE -112 -256 -112 -320
WIRE 688 -256 688 -336
WIRE -1600 -240 -1600 -432
WIRE 128 -240 128 -432
WIRE 224 -240 224 -432
WIRE 320 -240 320 -288
WIRE 416 -240 416 -320
WIRE -1296 -208 -1296 -256
WIRE -1056 -208 -1056 -256
WIRE -1376 -192 -1376 -432
WIRE -752 -176 -752 -256
WIRE -640 -176 -752 -176
WIRE 64 -176 -640 -176
WIRE 640 -176 480 -176
WIRE 832 -176 832 -336
WIRE 944 -176 944 -336
WIRE 1152 -176 1152 -336
WIRE -752 -144 -752 -176
WIRE -640 -144 -640 -176
WIRE 688 -144 688 -160
WIRE 688 -144 576 -144
WIRE 688 -112 688 -144
WIRE -1296 -96 -1296 -128
WIRE -1056 -96 -1056 -128
WIRE -848 -96 -1056 -96
WIRE -1600 -80 -1600 -160
WIRE -1376 -80 -1376 -112
WIRE -336 -80 -432 -80
WIRE -128 -80 -336 -80
WIRE 64 -80 48 -80
WIRE 576 -80 576 -144
WIRE 576 -80 480 -80
WIRE -896 -64 -896 -256
WIRE -848 -64 -848 -96
WIRE -800 -64 -848 -64
WIRE -1056 -48 -1056 -96
WIRE -336 -48 -336 -80
WIRE -1088 -16 -1104 -16
WIRE -976 -16 -1024 -16
WIRE -752 0 -752 -48
WIRE -640 0 -640 -64
WIRE 0 16 -128 -80
WIRE 64 16 0 16
WIRE 688 16 688 -32
WIRE 688 16 480 16
WIRE 832 16 832 -112
WIRE 832 16 688 16
WIRE 944 16 944 -112
WIRE 944 16 832 16
WIRE 1152 16 1152 -112
WIRE 1152 16 944 16
WIRE -1376 32 -1376 0
WIRE -1072 32 -1072 16
WIRE -1072 32 -1376 32
WIRE -1040 32 -1040 16
WIRE -896 32 -896 16
WIRE -896 32 -1040 32
WIRE -128 32 -176 32
WIRE -32 32 -128 32
WIRE 688 48 688 16
WIRE -1376 64 -1376 32
WIRE -896 64 -896 32
WIRE -336 64 -336 32
WIRE -128 64 -128 32
WIRE 1168 96 976 96
WIRE 1200 96 1168 96
WIRE 1312 96 1280 96
WIRE 1392 96 1392 -336
WIRE 1392 96 1376 96
WIRE -32 112 -32 32
WIRE 64 112 -32 112
WIRE 864 112 480 112
WIRE 912 112 864 112
WIRE 1072 128 976 128
WIRE -1376 160 -1376 144
WIRE -896 160 -896 144
WIRE -608 160 -672 160
WIRE -544 160 -544 -432
WIRE -544 160 -608 160
WIRE -128 176 -128 144
WIRE 1168 176 1168 96
WIRE -464 208 -544 208
WIRE -384 208 -464 208
WIRE 64 208 -384 208
WIRE 704 208 480 208
WIRE 832 208 704 208
WIRE 864 224 864 112
WIRE 928 224 864 224
WIRE 1072 224 1072 128
WIRE 1072 224 1008 224
WIRE -672 240 -672 160
WIRE -464 240 -464 208
WIRE -384 240 -384 208
WIRE 704 240 704 208
WIRE 1072 288 1072 224
WIRE 64 304 -240 304
WIRE 608 304 480 304
WIRE -464 336 -464 304
WIRE -384 336 -384 320
WIRE 1168 336 1168 256
WIRE -240 352 -240 304
WIRE 608 368 608 304
WIRE 704 368 704 320
WIRE 704 368 608 368
WIRE 704 384 704 368
WIRE -832 400 -880 400
WIRE -672 400 -672 320
WIRE -672 400 -752 400
WIRE 64 400 -96 400
WIRE 656 400 480 400
WIRE 1072 416 1072 368
WIRE 1120 416 1072 416
WIRE 1072 432 1072 416
WIRE -1296 448 -1296 416
WIRE -608 448 -608 160
WIRE -608 448 -768 448
WIRE -576 464 -704 464
WIRE -448 464 -576 464
WIRE -240 464 -240 416
WIRE 832 480 832 208
WIRE 1392 480 1392 96
WIRE 1392 480 832 480
WIRE -704 496 -704 464
WIRE -672 496 -672 400
WIRE -576 496 -576 464
WIRE -544 496 -544 208
WIRE 64 496 0 496
WIRE 576 496 480 496
WIRE -768 528 -768 448
WIRE -720 528 -768 528
WIRE -608 528 -608 448
WIRE -592 528 -608 528
WIRE 704 528 704 480
WIRE -96 544 -96 400
WIRE 0 544 0 496
WIRE 576 544 576 496
WIRE -688 576 -688 560
WIRE -560 576 -560 560
WIRE -1296 592 -1296 528
WIRE 128 608 128 560
WIRE 224 608 224 560
WIRE 432 640 432 560
WIRE -832 656 -880 656
WIRE -688 656 -688 640
WIRE -688 656 -752 656
WIRE -560 656 -560 640
WIRE -560 656 -688 656
WIRE -448 656 -448 464
WIRE -448 656 -560 656
WIRE 576 672 576 608
WIRE -96 688 -96 624
WIRE 0 688 0 624
WIRE 128 720 128 672
WIRE 704 720 704 592
WIRE 224 736 224 688
WIRE 432 752 432 704
WIRE 128 848 128 800
WIRE 704 880 704 800
WIRE -560 944 -560 656
WIRE 320 944 320 560
WIRE 320 944 -560 944
WIRE 704 1024 704 960
FLAG 224 736 0
FLAG 688 48 0
FLAG 128 848 0
FLAG 432 752 0
FLAG -240 464 0
FLAG -464 336 0
FLAG -384 336 0
FLAG 704 1024 0
FLAG -1600 -80 0
FLAG -368 -256 0
FLAG -256 -256 0
FLAG -112 -256 0
FLAG -96 400 Vfault
FLAG 0 496 Vmode
FLAG 576 672 0
FLAG -336 64 0
FLAG -432 -80 Vctrl_I
FLAG 1168 336 0
FLAG 0 688 Vcc
FLAG -96 688 Vcc
FLAG -1296 592 0
FLAG -1296 416 Vcc
FLAG -240 304 Vismon
FLAG -128 176 0
FLAG -176 32 Vctrl_pulse
FLAG 1072 432 Vctrl_V
FLAG 1120 416 0
FLAG 128 -560 0
FLAG -336 -80 Vcc
FLAG -128 32 Vcc
FLAG -1296 -96 0
FLAG -1376 160 0
FLAG -1104 -16 0
FLAG -896 160 0
FLAG -976 -16 Vi
FLAG -1440 -432 Vi
FLAG -752 0 0
FLAG -640 0 0
FLAG -880 656 0
FLAG -880 400 0
FLAG -656 528 0
FLAG -528 528 0
DATAFLAG 560 400 ""
DATAFLAG 896 480 ""
SYMBOL PowerProducts\\LT3796 272 160 R0
SYMATTR InstName U1
SYMBOL voltage -1600 -256 M0
WINDOW 123 0 0 Left 0
WINDOW 39 24 44 Left 2
SYMATTR SpiceLine Rser=20m
SYMATTR InstName V1
SYMATTR Value 18
SYMBOL cap 592 544 M0
SYMATTR InstName C1
SYMATTR Value 4.7µF
SYMATTR SpiceLine V=16V
SYMBOL cap 416 640 R0
SYMATTR InstName C2
SYMATTR Value 0.1µ
SYMBOL res 208 592 R0
SYMATTR InstName R1
SYMATTR Value 19.6k
SYMBOL res 688 224 R0
SYMATTR InstName R2
SYMATTR Value 75m
SYMBOL res 672 -128 R0
SYMATTR InstName R3
SYMATTR Value 8.2m
SYMBOL nmos 640 -256 R0
SYMATTR InstName M1
SYMATTR Value irf7470
SYMATTR Prefix X
SYMBOL res -656 -48 M180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R4
SYMATTR Value 5.6k
SYMBOL res -768 -352 R0
SYMATTR InstName R5
SYMATTR Value 27k
SYMBOL res -400 336 M180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R6
SYMATTR Value 27k
SYMBOL res 16 640 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R7
SYMATTR Value 100k
SYMBOL ind 496 -416 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value 68µ
SYMATTR SpiceLine Ipk=10.6 Rser=10.3m
SYMBOL pmos 656 480 M180
SYMATTR InstName M2
SYMATTR Value irf9317
SYMATTR Prefix X
SYMBOL res -80 528 M0
SYMATTR InstName R8
SYMATTR Value 100k
SYMBOL cap 112 608 R0
SYMATTR InstName C4
SYMATTR Value 0.22µ
SYMBOL res 112 704 R0
SYMATTR InstName R9
SYMATTR Value 2.2k
SYMBOL cap -480 240 R0
SYMATTR InstName C5
SYMATTR Value 10n
SYMBOL cap -256 352 R0
SYMATTR InstName C6
SYMATTR Value 0.1µ
SYMBOL cap -384 -384 R0
SYMATTR InstName C3
SYMATTR Value 1000µ
SYMATTR SpiceLine V=35 Irms=2.4 Rser=47m
SYMBOL ind 992 -320 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L2
SYMATTR Value 0.82µ
SYMATTR SpiceLine Ipk=4.75 Rser=9.5m
SYMBOL cap 1136 -176 R0
SYMATTR InstName C8
SYMATTR Value 220µ
SYMATTR SpiceLine V=35
SYMBOL Misc\\battery 704 704 R0
WINDOW 123 0 0 Left 0
WINDOW 39 24 132 Left 2
SYMATTR SpiceLine Rser=28m
SYMATTR InstName V2
SYMATTR Value 14.6
SYMBOL Misc\\battery 704 864 R0
WINDOW 123 0 0 Left 0
WINDOW 39 24 132 Left 2
SYMATTR SpiceLine Rser=28m
SYMATTR InstName V3
SYMATTR Value 14.6
SYMBOL cap -272 -384 R0
SYMATTR InstName C9
SYMATTR Value 1000µ
SYMATTR SpiceLine V=35 Irms=2.4 Rser=47m
SYMBOL cap -128 -384 R0
SYMATTR InstName C10
SYMATTR Value 10µ
SYMATTR SpiceLine V=35 Rser=2.2m
SYMBOL res 1024 208 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value 27k
SYMBOL res 1088 384 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R13
SYMATTR Value 27k
SYMBOL res 1152 160 R0
SYMATTR InstName R14
SYMATTR Value 2.2
SYMBOL cap 816 -176 R0
SYMATTR InstName C7
SYMATTR Value 2400µ
SYMATTR SpiceLine V=35 Irms=3.25 Rser=65m
SYMBOL cap 928 -176 R0
SYMATTR InstName C11
SYMATTR Value 2400µ
SYMATTR SpiceLine V=35 Irms=3.25 Rser=65m
SYMBOL res 448 -448 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R16
SYMATTR Value 8.2m
SYMBOL res 304 -384 R0
SYMATTR InstName R17
SYMATTR Value 1.8k
SYMBOL res -320 -64 M0
SYMATTR InstName R18
SYMATTR Value 100k
SYMBOL res 1296 80 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R19
SYMATTR Value 100k
SYMBOL voltage -1296 432 M0
WINDOW 123 0 0 Left 0
WINDOW 39 24 124 Left 2
SYMATTR SpiceLine Rser=30m
SYMATTR InstName V4
SYMATTR Value 3.3
SYMBOL res -112 48 M0
SYMATTR InstName R20
SYMATTR Value 100k
SYMBOL diode 736 -320 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMATTR Value MBRB1645
SYMBOL Opamps\\opamp 944 176 R180
SYMATTR InstName U2
SYMATTR SpiceLine2 GBW=1Meg
SYMBOL diode 688 528 R0
SYMATTR InstName D2
SYMATTR Value MBRB1645
SYMBOL pmos -976 -384 M270
SYMATTR InstName M3
SYMATTR Value irf9317
SYMATTR Prefix X
SYMBOL res -1312 -224 R0
SYMATTR InstName R22
SYMATTR Value 1.8k
SYMBOL cap 112 -560 R0
SYMATTR InstName C13
SYMATTR Value 0.22µ
SYMBOL cap -944 -272 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C12
SYMATTR Value 0.22µ
SYMBOL cap -1312 -400 R0
SYMATTR InstName C14
SYMATTR Value 4.7µ
SYMBOL res -1072 -272 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 1000k
SYMBOL diode -1168 -320 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D3
SYMATTR Value 1N4148
SYMBOL Opamps\\opamp2 -992 -16 M270
SYMATTR InstName U3
SYMATTR Value BA8391
SYMBOL res -1392 16 M180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R11
SYMATTR Value 100k
SYMBOL res -1392 160 M180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R15
SYMATTR Value 100k
SYMBOL res -912 32 M180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R21
SYMATTR Value 100k
SYMBOL res -912 160 M180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R23
SYMATTR Value 100k
SYMBOL res -1072 -224 R0
SYMATTR InstName R24
SYMATTR Value 1.8k
SYMBOL nmos -800 -144 R0
SYMATTR InstName M4
SYMATTR Value Si7336ADP
SYMBOL res -1392 -208 R0
SYMATTR InstName R25
SYMATTR Value 1.8k
SYMBOL diode 1376 80 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D4
SYMATTR Value MBRB1645
SYMBOL res -736 640 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R27
SYMATTR Value 100k
SYMBOL diode -576 576 R0
SYMATTR InstName D5
SYMATTR Value 1N4148
SYMBOL diode -704 576 R0
SYMATTR InstName D6
SYMATTR Value 1N4148
SYMBOL res -736 384 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R26
SYMATTR Value 1.8k
SYMBOL res -688 224 R0
SYMATTR InstName R28
SYMATTR Value 27k
SYMBOL Opamps\\UniversalOpamp2 -560 528 M90
SYMATTR InstName U6
SYMBOL Opamps\\UniversalOpamp2 -688 528 M90
SYMATTR InstName U4
TEXT -968 400 Right 2 !.lib irf7470.spi
TEXT -1072 464 Left 2 !.lib irf9317.spi
TEXT -1072 544 Left 2 !.lib TSX561.txt
TEXT -1152 280 Left 2 !.lib MBRB1645.spi
TEXT -1032 952 Left 2 !.tran 0 1 0 1m startup
TEXT -1072 504 Left 2 !.lib opamp.sub
TEXT -968 328 Right 2 !.lib BA8391.lib
